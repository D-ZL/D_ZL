# Shell

脚本开头最好使用 `#!/usr/bin/env bash`

## 变量

变量赋值时 `=` 前后不能加空格
访问变量时，必须加上 `$`

```sh
test="test"
echo $test
```

### 默认值

```
${var:-def} # 不存在或为空就返回默认
${var:+def} # 存在且不为空返回默认
${var:=def} # 不存在或为空就返回默认并设置为默认
${var:?def} # 存在且不为空，则返回它的值，否则打印出 varname: message，并中断脚本的执行
${[1-9]}    # 1-9 表示脚本参数
```

## 运算符

### 算术运算符

- `+` 加法运算
- `-` 减法运算
- `*` 乘法运算
- `/` 除法运算
- `%` 求余运算

    运算符号前后一定要加空格，乘法运算符号需要转义

```sh
expr 1 + 2
expr 3 - 2
expr 4 \* 2
expr 6 / 2
```

### 赋值运算符

- `=` 赋值

### 比较运算符

- `==` 相等
- `!=` 不相等

### 逻辑运算符

- `!` 非
- `-o` 或
- `-a` 与

### 关系运算符

- `-eq` 两个数相等
- `-ne` 两个数不相等
- `-gt` 左侧数大于右侧数
- `-lt` 左侧数小于右侧数
- `-ge` 左侧数大于等于右侧数
- `-le` 左侧数小于等于右侧数

### 字符串运算符

- `=` 两个字符串相等
- `!=` 两个字符串不相等
- `-z` 字符串长度为 0
- `-n` 字符串长度不为 0

### test

- `-d file` 检测文件是否是目录
- `-r file` 检测文件是否可读
- `-w file` 检测文件是否可写
- `-x file` 检测文件是否可执行
- `-s file` 检测文件是否为空（文件大小是否大于 0），不为空返回 `true`
- `-e file` 检测文件（包括目录）是否存在

### 特殊变量


- `$?` 上个命令的退出状态，或函数的返回值。一般情况下，大部分命令执行成功会返回 0，失败返回 1。
- `$$` 当前 Shell 进程 ID。对于 Shell 脚本，就是这些脚本所在的进程 ID。
- `$_` 为上一个命令的最后一个参数
- `$!` 为最近一个后台执行的异步命令的进程 ID
- `$0` 当前脚本的文件名
- `$-` 当前 Shell 的启动参数
- `$n` 传递给脚本或函数的参数。n 是一个数字，表示第几个参数。例如，第一个参数是 $1，第二个参数是 $2。
- `$#` 传递给脚本或函数的参数个数。
- `$*` 传递给脚本或函数的所有参数。
- `$@` 传递给脚本或函数的所有参数。被双引号 (" ") 包含时，与 $* 稍有不同，下面将会讲到。

> `$*` 和 `$@` 都表示传递给函数或脚本的所有参数，不被双引号 (" ") 包含时，都以"$1" "$2" … "$n" 的形式输出所有参数
> 但是当它们被双引号 (" ") 包含时
> `$*` 会将所有的参数作为一个整体，以"$1 $2 … $n"的形式输出所有参数
> `$@` 会将各个参数分开，以"$1" "$2" … "$n" 的形式输出所有参数


## 字符类

- `[[:alnum:]]`：匹配任意英文字母与数字
- `[[:alpha:]]`：匹配任意英文字母
- `[[:blank:]]`：空格和 Tab 键。
- `[[:cntrl:]]`：ASCII 码 0-31 的不可打印字符。
- `[[:digit:]]`：匹配任意数字 0-9。
- `[[:graph:]]`：A-Z、a-z、0-9 和标点符号。
- `[[:lower:]]`：匹配任意小写字母 a-z。
- `[[:print:]]`：ASCII 码 32-127 的可打印字符。
- `[[:punct:]]`：标点符号（除了 A-Z、a-z、0-9 的可打印字符）。
- `[[:space:]]`：空格、Tab、LF（10）、VT（11）、FF（12）、CR（13）。
- `[[:upper:]]`：匹配任意大写字母 A-Z。
- `[[:xdigit:]]`：16 进制字符（A-F、a-f、0-9）。
