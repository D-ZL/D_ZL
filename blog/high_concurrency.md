# 高并发

- 先修改数据在删缓存

- 只记记录，把相关金额计算到内存

- CAS乐观所，使用旧的金额做Where条件来限制，更改保证了幂等

- 流水表只增不减，可在余额表中添加最后一次流水，做乐观锁

- 如记录中要记录余额，做好索引，使用update索引行锁先更新在查

- 可使用redis `increment` 的原子性做库存管理，异步生成订单
